files:
  "/etc/nginx/conf.d/https_redirect.conf":
    mode: "000644"
    owner: root
    group: root
    content: |
      server {
          listen 80;
          return 301 https://$host$request_uri;
      }

  "/etc/nginx/conf.d/security_headers.conf":
    mode: "000644"
    owner: root
    group: root
    content: |
      add_header X-Frame-Options DENY always;
      add_header X-Content-Type-Options nosniff always;
      add_header Referrer-Policy strict-origin-when-cross-origin always;
      add_header Permissions-Policy "geolocation=(), microphone=(), camera=()" always;

container_commands:
  01_reload_nginx:
    command: "service nginx reload"